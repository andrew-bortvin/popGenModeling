<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Class 7: Infectious Diseases | Population Genetics Modeling</title>
  <meta name="description" content="Description of Course" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Class 7: Infectious Diseases | Population Genetics Modeling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Description of Course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Class 7: Infectious Diseases | Population Genetics Modeling" />
  
  <meta name="twitter:description" content="Description of Course" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/pig.jpg" type="image/x-icon" />
<link rel="prev" href="class-5-lotka-volterra-i-competition.html"/>
<link rel="next" href="class-9-the-wright-fisher-model-i---neutral-evolution.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://andrew-bortvin.github.io/popGenModeling/"><img src="assets/pig.jpg" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top"</a>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Homepage</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#course-updates"><i class="fa fa-check"></i><b>1.0.1</b> Course Updates</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="course-syllabus.html"><a href="course-syllabus.html"><i class="fa fa-check"></i><b>2</b> Course Syllabus</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="course-syllabus.html"><a href="course-syllabus.html#course-description"><i class="fa fa-check"></i><b>2.0.1</b> Course Description</a></li>
<li class="chapter" data-level="2.0.2" data-path="course-syllabus.html"><a href="course-syllabus.html#learning-goals"><i class="fa fa-check"></i><b>2.0.2</b> Learning Goals</a></li>
<li class="chapter" data-level="2.0.3" data-path="course-syllabus.html"><a href="course-syllabus.html#grading"><i class="fa fa-check"></i><b>2.0.3</b> Grading</a></li>
<li class="chapter" data-level="2.0.4" data-path="course-syllabus.html"><a href="course-syllabus.html#schedule"><i class="fa fa-check"></i><b>2.0.4</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lecture-notes.html"><a href="lecture-notes.html"><i class="fa fa-check"></i><b>3</b> Lecture Notes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html"><i class="fa fa-check"></i><b>3.1</b> Class 2: Intro to R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#data-types-variables-math"><i class="fa fa-check"></i><b>3.1.1</b> Data Types, Variables, Math</a></li>
<li class="chapter" data-level="3.1.2" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#comparing-values"><i class="fa fa-check"></i><b>3.1.2</b> Comparing Values</a></li>
<li class="chapter" data-level="3.1.3" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#collections"><i class="fa fa-check"></i><b>3.1.3</b> Collections</a></li>
<li class="chapter" data-level="3.1.4" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#iteration"><i class="fa fa-check"></i><b>3.1.4</b> Iteration</a></li>
<li class="chapter" data-level="3.1.5" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#data-frames-tabular-data"><i class="fa fa-check"></i><b>3.1.5</b> Data Frames: Tabular Data</a></li>
<li class="chapter" data-level="3.1.6" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#plotting"><i class="fa fa-check"></i><b>3.1.6</b> Plotting</a></li>
<li class="chapter" data-level="3.1.7" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#wide-to-long"><i class="fa fa-check"></i><b>3.1.7</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html"><i class="fa fa-check"></i><b>3.2</b> Class 3: Exponential Growth and Age Structure</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#comparison-to-real-data"><i class="fa fa-check"></i><b>3.2.1</b> Comparison to Real Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#age-structure"><i class="fa fa-check"></i><b>3.2.2</b> Age Structure</a></li>
<li class="chapter" data-level="3.2.3" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#the-leslie-matrix"><i class="fa fa-check"></i><b>3.2.3</b> The Leslie Matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="class-5-lotka-volterra-i-competition.html"><a href="class-5-lotka-volterra-i-competition.html"><i class="fa fa-check"></i><b>3.3</b> Class 5: Lotka-Volterra I: Competition</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="class-5-lotka-volterra-i-competition.html"><a href="class-5-lotka-volterra-i-competition.html#equilibirum-from-multiple-starting-points"><i class="fa fa-check"></i><b>3.3.1</b> Equilibirum from multiple starting points</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html"><i class="fa fa-check"></i><b>3.4</b> Class 7: Infectious Diseases</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#the-sir-model"><i class="fa fa-check"></i><b>3.4.1</b> The SIR Model</a></li>
<li class="chapter" data-level="3.4.2" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#seir"><i class="fa fa-check"></i><b>3.4.2</b> SEIR</a></li>
<li class="chapter" data-level="3.4.3" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#seihfr"><i class="fa fa-check"></i><b>3.4.3</b> SEIHFR</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="class-9-the-wright-fisher-model-i---neutral-evolution.html"><a href="class-9-the-wright-fisher-model-i---neutral-evolution.html"><i class="fa fa-check"></i><b>3.5</b> Class 9: The Wright-Fisher Model I - Neutral Evolution</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="class-9-the-wright-fisher-model-i---neutral-evolution.html"><a href="class-9-the-wright-fisher-model-i---neutral-evolution.html#random-walks"><i class="fa fa-check"></i><b>3.5.1</b> Random Walks</a></li>
<li class="chapter" data-level="3.5.2" data-path="class-9-the-wright-fisher-model-i---neutral-evolution.html"><a href="class-9-the-wright-fisher-model-i---neutral-evolution.html#wright-fisher-simulation"><i class="fa fa-check"></i><b>3.5.2</b> Wright-Fisher Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-guidebook.html"><a href="r-guidebook.html"><i class="fa fa-check"></i><b>4</b> R Guidebook</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>4.1</b> Data Types</a></li>
<li class="chapter" data-level="4.2" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>4.2</b> Variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="variables.html"><a href="variables.html#overwriting-variables"><i class="fa fa-check"></i><b>4.2.1</b> Overwriting Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>4.3</b> Math</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="math.html"><a href="math.html#order-of-operations"><i class="fa fa-check"></i><b>4.3.1</b> Order of Operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="comparisons.html"><a href="comparisons.html"><i class="fa fa-check"></i><b>4.4</b> Comparisons</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="comparisons.html"><a href="comparisons.html#and-and-or"><i class="fa fa-check"></i><b>4.4.1</b> AND and OR</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>4.5</b> Vectors</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="vectors.html"><a href="vectors.html#indexing-1"><i class="fa fa-check"></i><b>4.5.1</b> Indexing</a></li>
<li class="chapter" data-level="4.5.2" data-path="vectors.html"><a href="vectors.html#logical-indexing-1"><i class="fa fa-check"></i><b>4.5.2</b> Logical Indexing</a></li>
<li class="chapter" data-level="4.5.3" data-path="vectors.html"><a href="vectors.html#modifying-vectors"><i class="fa fa-check"></i><b>4.5.3</b> Modifying Vectors</a></li>
<li class="chapter" data-level="4.5.4" data-path="vectors.html"><a href="vectors.html#adding-to-vectors-1"><i class="fa fa-check"></i><b>4.5.4</b> Adding to Vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>4.6</b> Data Frames</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-frames.html"><a href="data-frames.html#subsetting-data-frames"><i class="fa fa-check"></i><b>4.6.1</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="4.6.2" data-path="data-frames.html"><a href="data-frames.html#logical-indexing-2"><i class="fa fa-check"></i><b>4.6.2</b> Logical Indexing</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="plotting-1.html"><a href="plotting-1.html"><i class="fa fa-check"></i><b>4.7</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-slides.html"><a href="lecture-slides.html"><i class="fa fa-check"></i><b>5</b> Lecture Slides</a></li>
<li class="chapter" data-level="" data-path="authors.html"><a href="authors.html"><i class="fa fa-check"></i>Authors</a></li>
<li class="divider"></li>
<p style="text-align:center; font-size: 11pt"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > Published with</a> <a href="https://bookdown.org/" target="blank"> <b>bookdown</b></a> (by <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab</a>) </p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Population Genetics Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,initial-scale=1.0">
  <link href="assets/style.css" rel="stylesheet">
</head>



<div class="hero-image-container">
  <img class="hero-image" src="assets/ilum.jpg">
</div>
<div id="class-7-infectious-diseases" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Class 7: Infectious Diseases<a href="class-7-infectious-diseases.html#class-7-infectious-diseases" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before getting into any biology, let’s learn about making our own functions. Throughout the course, we’ve made use of R functions such as <code>print()</code>, <code>c()</code>, and <code>ggplot()</code>; defining our own functions allows us to</p>
<p>Defining our own functions allows us to perform actions over and over on multiple sets of inputs.</p>
<p>Below, let’s practice creating a function that takes one input, a list, and returns the number of things in it:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="class-7-infectious-diseases.html#cb166-1" tabindex="-1"></a><span class="co"># A vector containing the contents of my fridge </span></span>
<span id="cb166-2"><a href="class-7-infectious-diseases.html#cb166-2" tabindex="-1"></a>refrigerator <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Apples&quot;</span>, <span class="st">&quot;Pears&quot;</span>, <span class="st">&quot;Bread&quot;</span>, <span class="st">&quot;Eggs&quot;</span>, <span class="st">&quot;Cheddar&quot;</span>,</span>
<span id="cb166-3"><a href="class-7-infectious-diseases.html#cb166-3" tabindex="-1"></a>                  <span class="st">&quot;Brie&quot;</span>, <span class="st">&quot;Lettuce&quot;</span>, <span class="st">&quot;Shallots&quot;</span>, <span class="st">&quot;Cabbage&quot;</span>)</span>
<span id="cb166-4"><a href="class-7-infectious-diseases.html#cb166-4" tabindex="-1"></a></span>
<span id="cb166-5"><a href="class-7-infectious-diseases.html#cb166-5" tabindex="-1"></a><span class="co"># The function definition </span></span>
<span id="cb166-6"><a href="class-7-infectious-diseases.html#cb166-6" tabindex="-1"></a>countFood <span class="ot">&lt;-</span> <span class="cf">function</span>(fridge){ <span class="co"># Fridge is a local variable - it does not exist outside the function </span></span>
<span id="cb166-7"><a href="class-7-infectious-diseases.html#cb166-7" tabindex="-1"></a>  numItems <span class="ot">&lt;-</span> <span class="fu">length</span>(fridge)</span>
<span id="cb166-8"><a href="class-7-infectious-diseases.html#cb166-8" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;I have&quot;</span>, numItems, <span class="st">&quot;things in my fridge.&quot;</span>))</span>
<span id="cb166-9"><a href="class-7-infectious-diseases.html#cb166-9" tabindex="-1"></a>}</span>
<span id="cb166-10"><a href="class-7-infectious-diseases.html#cb166-10" tabindex="-1"></a></span>
<span id="cb166-11"><a href="class-7-infectious-diseases.html#cb166-11" tabindex="-1"></a><span class="co"># Two more fridges </span></span>
<span id="cb166-12"><a href="class-7-infectious-diseases.html#cb166-12" tabindex="-1"></a>myFriendsPantry <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;olives&quot;</span>)</span>
<span id="cb166-13"><a href="class-7-infectious-diseases.html#cb166-13" tabindex="-1"></a>fridge <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;veal&quot;</span>, <span class="st">&quot;steak&quot;</span>, <span class="st">&quot;halloumi&quot;</span>)</span>
<span id="cb166-14"><a href="class-7-infectious-diseases.html#cb166-14" tabindex="-1"></a></span>
<span id="cb166-15"><a href="class-7-infectious-diseases.html#cb166-15" tabindex="-1"></a><span class="co"># Run the fridge function on all three sets of inputs: </span></span>
<span id="cb166-16"><a href="class-7-infectious-diseases.html#cb166-16" tabindex="-1"></a><span class="fu">countFood</span>(refrigerator)</span></code></pre></div>
<pre><code>## [1] &quot;I have 9 things in my fridge.&quot;</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="class-7-infectious-diseases.html#cb168-1" tabindex="-1"></a><span class="fu">countFood</span>(myFriendsPantry)</span></code></pre></div>
<pre><code>## [1] &quot;I have 1 things in my fridge.&quot;</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="class-7-infectious-diseases.html#cb170-1" tabindex="-1"></a><span class="fu">countFood</span>(fridge)</span></code></pre></div>
<pre><code>## [1] &quot;I have 3 things in my fridge.&quot;</code></pre>
<p>The <code>countFood()</code> function prints out a value, but doesn’t actually store anything to memory. Very often, we want to use the output from our function for downstream analysis. To save the oputput of our function, we need to include a <code>return()</code> statement.</p>
<p>For example, the function below generates a poly A tail sequence by pasting together a series of <code>"A"</code>’s, taking as input the length of the sequence to return:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="class-7-infectious-diseases.html#cb172-1" tabindex="-1"></a><span class="co"># Define function</span></span>
<span id="cb172-2"><a href="class-7-infectious-diseases.html#cb172-2" tabindex="-1"></a>polyAtail <span class="ot">&lt;-</span> <span class="cf">function</span>(length){</span>
<span id="cb172-3"><a href="class-7-infectious-diseases.html#cb172-3" tabindex="-1"></a>  polyA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="at">times =</span> length) <span class="co"># Create a vector of A&#39;s</span></span>
<span id="cb172-4"><a href="class-7-infectious-diseases.html#cb172-4" tabindex="-1"></a></span>
<span id="cb172-5"><a href="class-7-infectious-diseases.html#cb172-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">paste</span>(polyA, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="co"># Convert that vector into a string</span></span>
<span id="cb172-6"><a href="class-7-infectious-diseases.html#cb172-6" tabindex="-1"></a>}</span>
<span id="cb172-7"><a href="class-7-infectious-diseases.html#cb172-7" tabindex="-1"></a></span>
<span id="cb172-8"><a href="class-7-infectious-diseases.html#cb172-8" tabindex="-1"></a><span class="co"># Run polyAtail() function on two inputs</span></span>
<span id="cb172-9"><a href="class-7-infectious-diseases.html#cb172-9" tabindex="-1"></a>polyA <span class="ot">&lt;-</span> <span class="fu">polyAtail</span>(<span class="dv">63</span>)</span>
<span id="cb172-10"><a href="class-7-infectious-diseases.html#cb172-10" tabindex="-1"></a>polyA2 <span class="ot">&lt;-</span> <span class="fu">polyAtail</span>(<span class="dv">17</span>)</span>
<span id="cb172-11"><a href="class-7-infectious-diseases.html#cb172-11" tabindex="-1"></a></span>
<span id="cb172-12"><a href="class-7-infectious-diseases.html#cb172-12" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb172-13"><a href="class-7-infectious-diseases.html#cb172-13" tabindex="-1"></a><span class="fu">print</span>(polyA)</span></code></pre></div>
<pre><code>## [1] &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="class-7-infectious-diseases.html#cb174-1" tabindex="-1"></a><span class="fu">print</span>(polyA2)</span></code></pre></div>
<pre><code>## [1] &quot;AAAAAAAAAAAAAAAAA&quot;</code></pre>
<div id="the-sir-model" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> The SIR Model<a href="class-7-infectious-diseases.html#the-sir-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the function below, we implement the simplest form of the SIR model. The SIR model tracks the numbers of <strong>S</strong>usceptible, <strong>I</strong>nfected, and <strong>R</strong>ecovered individuals in a population, assuming a constant birth/death rate. :</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="class-7-infectious-diseases.html#cb176-1" tabindex="-1"></a>SIR <span class="ot">&lt;-</span> <span class="cf">function</span>(S, I, R, <span class="co"># Starting number of individuals, as a fraction of total population size</span></span>
<span id="cb176-2"><a href="class-7-infectious-diseases.html#cb176-2" tabindex="-1"></a>                mu, B, gamma, <span class="co"># death/birth rate, contact lengths, recovery rate</span></span>
<span id="cb176-3"><a href="class-7-infectious-diseases.html#cb176-3" tabindex="-1"></a>                simTime, step){</span>
<span id="cb176-4"><a href="class-7-infectious-diseases.html#cb176-4" tabindex="-1"></a>  </span>
<span id="cb176-5"><a href="class-7-infectious-diseases.html#cb176-5" tabindex="-1"></a>  <span class="co"># Initialize total population size</span></span>
<span id="cb176-6"><a href="class-7-infectious-diseases.html#cb176-6" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb176-7"><a href="class-7-infectious-diseases.html#cb176-7" tabindex="-1"></a>  </span>
<span id="cb176-8"><a href="class-7-infectious-diseases.html#cb176-8" tabindex="-1"></a>  <span class="co"># lists to store population sizes</span></span>
<span id="cb176-9"><a href="class-7-infectious-diseases.html#cb176-9" tabindex="-1"></a>  sList <span class="ot">&lt;-</span> <span class="fu">c</span>(S)</span>
<span id="cb176-10"><a href="class-7-infectious-diseases.html#cb176-10" tabindex="-1"></a>  iList <span class="ot">&lt;-</span> <span class="fu">c</span>(I)</span>
<span id="cb176-11"><a href="class-7-infectious-diseases.html#cb176-11" tabindex="-1"></a>  rList <span class="ot">&lt;-</span> <span class="fu">c</span>(R)</span>
<span id="cb176-12"><a href="class-7-infectious-diseases.html#cb176-12" tabindex="-1"></a>  </span>
<span id="cb176-13"><a href="class-7-infectious-diseases.html#cb176-13" tabindex="-1"></a>  <span class="co"># loop through times</span></span>
<span id="cb176-14"><a href="class-7-infectious-diseases.html#cb176-14" tabindex="-1"></a>  <span class="cf">for</span> (time <span class="cf">in</span> <span class="fu">seq</span>(simTime<span class="sc">/</span>step)){</span>
<span id="cb176-15"><a href="class-7-infectious-diseases.html#cb176-15" tabindex="-1"></a>    <span class="co"># Calculate rates of change </span></span>
<span id="cb176-16"><a href="class-7-infectious-diseases.html#cb176-16" tabindex="-1"></a>    </span>
<span id="cb176-17"><a href="class-7-infectious-diseases.html#cb176-17" tabindex="-1"></a>    dS <span class="ot">&lt;-</span> (mu <span class="sc">*</span> (N <span class="sc">-</span> S) <span class="sc">-</span> B <span class="sc">*</span> I <span class="sc">*</span> S <span class="sc">/</span> N) <span class="sc">*</span> step</span>
<span id="cb176-18"><a href="class-7-infectious-diseases.html#cb176-18" tabindex="-1"></a>    dI <span class="ot">&lt;-</span> (B <span class="sc">*</span> I <span class="sc">*</span> S <span class="sc">/</span> N <span class="sc">-</span> (mu <span class="sc">+</span> gamma) <span class="sc">*</span> I) <span class="sc">*</span> step</span>
<span id="cb176-19"><a href="class-7-infectious-diseases.html#cb176-19" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> (gamma <span class="sc">*</span> I <span class="sc">-</span> mu <span class="sc">*</span> R) <span class="sc">*</span> step</span>
<span id="cb176-20"><a href="class-7-infectious-diseases.html#cb176-20" tabindex="-1"></a>    </span>
<span id="cb176-21"><a href="class-7-infectious-diseases.html#cb176-21" tabindex="-1"></a>    <span class="co"># Update population sizes based on rate of change</span></span>
<span id="cb176-22"><a href="class-7-infectious-diseases.html#cb176-22" tabindex="-1"></a>    S <span class="ot">&lt;-</span> S <span class="sc">+</span> dS</span>
<span id="cb176-23"><a href="class-7-infectious-diseases.html#cb176-23" tabindex="-1"></a>    I <span class="ot">&lt;-</span> I <span class="sc">+</span> dI </span>
<span id="cb176-24"><a href="class-7-infectious-diseases.html#cb176-24" tabindex="-1"></a>    R <span class="ot">&lt;-</span> R <span class="sc">+</span> dR</span>
<span id="cb176-25"><a href="class-7-infectious-diseases.html#cb176-25" tabindex="-1"></a>    </span>
<span id="cb176-26"><a href="class-7-infectious-diseases.html#cb176-26" tabindex="-1"></a>    <span class="co"># Update lists</span></span>
<span id="cb176-27"><a href="class-7-infectious-diseases.html#cb176-27" tabindex="-1"></a>    sList <span class="ot">&lt;-</span> <span class="fu">c</span>(sList, S)</span>
<span id="cb176-28"><a href="class-7-infectious-diseases.html#cb176-28" tabindex="-1"></a>    iList <span class="ot">&lt;-</span> <span class="fu">c</span>(iList, I)</span>
<span id="cb176-29"><a href="class-7-infectious-diseases.html#cb176-29" tabindex="-1"></a>    rList <span class="ot">&lt;-</span> <span class="fu">c</span>(rList, R)</span>
<span id="cb176-30"><a href="class-7-infectious-diseases.html#cb176-30" tabindex="-1"></a>  }</span>
<span id="cb176-31"><a href="class-7-infectious-diseases.html#cb176-31" tabindex="-1"></a>  <span class="co"># Store results to data frame</span></span>
<span id="cb176-32"><a href="class-7-infectious-diseases.html#cb176-32" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb176-33"><a href="class-7-infectious-diseases.html#cb176-33" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(<span class="fu">length</span>(sList)) <span class="sc">*</span> step,</span>
<span id="cb176-34"><a href="class-7-infectious-diseases.html#cb176-34" tabindex="-1"></a>    <span class="at">S =</span> sList, </span>
<span id="cb176-35"><a href="class-7-infectious-diseases.html#cb176-35" tabindex="-1"></a>    <span class="at">I =</span> iList,</span>
<span id="cb176-36"><a href="class-7-infectious-diseases.html#cb176-36" tabindex="-1"></a>    <span class="at">R =</span> rList</span>
<span id="cb176-37"><a href="class-7-infectious-diseases.html#cb176-37" tabindex="-1"></a>  )</span>
<span id="cb176-38"><a href="class-7-infectious-diseases.html#cb176-38" tabindex="-1"></a>  </span>
<span id="cb176-39"><a href="class-7-infectious-diseases.html#cb176-39" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb176-40"><a href="class-7-infectious-diseases.html#cb176-40" tabindex="-1"></a>}</span></code></pre></div>
<p>The function above returns a data frame containing time and population size for individuals of all categories.</p>
<p>We would also like to plot our data. Since we may want to do this over and over again for different inputs, it also makes sense to plot through a function. Notice that because we just want to create a plot here, we don’t need to save anything to memory. Therefore, this function does not have a <code>return()</code> statement:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="class-7-infectious-diseases.html#cb177-1" tabindex="-1"></a><span class="co"># Define plotting function </span></span>
<span id="cb177-2"><a href="class-7-infectious-diseases.html#cb177-2" tabindex="-1"></a>plotSIR <span class="ot">&lt;-</span> <span class="cf">function</span>(SIR_data){</span>
<span id="cb177-3"><a href="class-7-infectious-diseases.html#cb177-3" tabindex="-1"></a>  <span class="co"># Convert to tall format</span></span>
<span id="cb177-4"><a href="class-7-infectious-diseases.html#cb177-4" tabindex="-1"></a>  SIR_data_tall <span class="ot">&lt;-</span> <span class="fu">melt</span>(SIR_data, <span class="at">id.vars =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb177-5"><a href="class-7-infectious-diseases.html#cb177-5" tabindex="-1"></a>  <span class="co"># Fix the column names</span></span>
<span id="cb177-6"><a href="class-7-infectious-diseases.html#cb177-6" tabindex="-1"></a>  <span class="fu">colnames</span>(SIR_data_tall) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Size&quot;</span>)</span>
<span id="cb177-7"><a href="class-7-infectious-diseases.html#cb177-7" tabindex="-1"></a>  </span>
<span id="cb177-8"><a href="class-7-infectious-diseases.html#cb177-8" tabindex="-1"></a>  <span class="co"># Plot, coloring by population </span></span>
<span id="cb177-9"><a href="class-7-infectious-diseases.html#cb177-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(SIR_data_tall, <span class="fu">aes</span>(<span class="at">x =</span> Time,</span>
<span id="cb177-10"><a href="class-7-infectious-diseases.html#cb177-10" tabindex="-1"></a>                            <span class="at">y =</span> Size, </span>
<span id="cb177-11"><a href="class-7-infectious-diseases.html#cb177-11" tabindex="-1"></a>                            <span class="at">color =</span> Population)) <span class="sc">+</span> </span>
<span id="cb177-12"><a href="class-7-infectious-diseases.html#cb177-12" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb177-13"><a href="class-7-infectious-diseases.html#cb177-13" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb177-14"><a href="class-7-infectious-diseases.html#cb177-14" tabindex="-1"></a>}</span></code></pre></div>
<p>We can also make a function to just plot the infected individuals. This is identical to the function above, except that we subset our individuals while plotting (<code>SIR_data_tall[SIR_data_tall$Population == "I", ]</code>):</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="class-7-infectious-diseases.html#cb178-1" tabindex="-1"></a><span class="co"># Define plotting function </span></span>
<span id="cb178-2"><a href="class-7-infectious-diseases.html#cb178-2" tabindex="-1"></a>plotInfected<span class="ot">&lt;-</span> <span class="cf">function</span>(SIR_data){</span>
<span id="cb178-3"><a href="class-7-infectious-diseases.html#cb178-3" tabindex="-1"></a>  <span class="co"># Convert to tall format</span></span>
<span id="cb178-4"><a href="class-7-infectious-diseases.html#cb178-4" tabindex="-1"></a>  SIR_data_tall <span class="ot">&lt;-</span> <span class="fu">melt</span>(SIR_data, <span class="at">id.vars =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb178-5"><a href="class-7-infectious-diseases.html#cb178-5" tabindex="-1"></a>  <span class="co"># Fix the column names</span></span>
<span id="cb178-6"><a href="class-7-infectious-diseases.html#cb178-6" tabindex="-1"></a>  <span class="fu">colnames</span>(SIR_data_tall) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Size&quot;</span>)</span>
<span id="cb178-7"><a href="class-7-infectious-diseases.html#cb178-7" tabindex="-1"></a>  </span>
<span id="cb178-8"><a href="class-7-infectious-diseases.html#cb178-8" tabindex="-1"></a>  <span class="co"># Plot, coloring by population </span></span>
<span id="cb178-9"><a href="class-7-infectious-diseases.html#cb178-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(SIR_data_tall[SIR_data_tall<span class="sc">$</span>Population <span class="sc">==</span> <span class="st">&quot;I&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Time,</span>
<span id="cb178-10"><a href="class-7-infectious-diseases.html#cb178-10" tabindex="-1"></a>                            <span class="at">y =</span> Size, </span>
<span id="cb178-11"><a href="class-7-infectious-diseases.html#cb178-11" tabindex="-1"></a>                            <span class="at">color =</span> Population)) <span class="sc">+</span> </span>
<span id="cb178-12"><a href="class-7-infectious-diseases.html#cb178-12" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb178-13"><a href="class-7-infectious-diseases.html#cb178-13" tabindex="-1"></a>    <span class="fu">theme_bw</span>() </span>
<span id="cb178-14"><a href="class-7-infectious-diseases.html#cb178-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we’ve defined our functions, we can run them on a set of data:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="class-7-infectious-diseases.html#cb179-1" tabindex="-1"></a><span class="co"># Initial fraction of populations in each category</span></span>
<span id="cb179-2"><a href="class-7-infectious-diseases.html#cb179-2" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fl">0.19</span></span>
<span id="cb179-3"><a href="class-7-infectious-diseases.html#cb179-3" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb179-4"><a href="class-7-infectious-diseases.html#cb179-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb179-5"><a href="class-7-infectious-diseases.html#cb179-5" tabindex="-1"></a></span>
<span id="cb179-6"><a href="class-7-infectious-diseases.html#cb179-6" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">50</span> <span class="sc">*</span> <span class="dv">52</span>) <span class="co"># Birth rate </span></span>
<span id="cb179-7"><a href="class-7-infectious-diseases.html#cb179-7" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Contact lengths </span></span>
<span id="cb179-8"><a href="class-7-infectious-diseases.html#cb179-8" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Recovery rate </span></span>
<span id="cb179-9"><a href="class-7-infectious-diseases.html#cb179-9" tabindex="-1"></a></span>
<span id="cb179-10"><a href="class-7-infectious-diseases.html#cb179-10" tabindex="-1"></a>simTime <span class="ot">&lt;-</span> <span class="dv">52</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb179-11"><a href="class-7-infectious-diseases.html#cb179-11" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb179-12"><a href="class-7-infectious-diseases.html#cb179-12" tabindex="-1"></a></span>
<span id="cb179-13"><a href="class-7-infectious-diseases.html#cb179-13" tabindex="-1"></a>SIR_data <span class="ot">&lt;-</span> <span class="fu">SIR</span>(S, I, R, mu, B, gamma,simTime, step)</span>
<span id="cb179-14"><a href="class-7-infectious-diseases.html#cb179-14" tabindex="-1"></a><span class="fu">plotSIR</span>(SIR_data)</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SIR_simple.png" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="class-7-infectious-diseases.html#cb180-1" tabindex="-1"></a><span class="fu">plotInfected</span>(SIR_data)</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SIR_simple_I.png" /></p>
<p>As with other multi-population models, we can the trajectories of multiple populations as they relate to each other:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="class-7-infectious-diseases.html#cb181-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>SIR_data, <span class="fu">aes</span>(<span class="at">x =</span> S, <span class="at">y =</span> I)) <span class="sc">+</span></span>
<span id="cb181-2"><a href="class-7-infectious-diseases.html#cb181-2" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SIR_simple_phase.png" /></p>
<p>Note that in this model, there is a cyclical oscillation approaching an equilibrium as time goes on. The new spikes in case number are a result of new births in the population increasing the susceptible population.</p>
</div>
<div id="seir" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> SEIR<a href="class-7-infectious-diseases.html#seir" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The SEIR model extends the standard SIR model by including a new phase - <strong>E</strong>xposed individuals. Exposed individuals have contracted the infection but are not yet symptomatic.</p>
<p>We’ve also added a couple new terms to make this model more realistic:</p>
<ol style="list-style-type: decimal">
<li><p>The parameter <code>p</code> now specifies the at birth vaccination rate. As a result, some fractions of individuals in each generation immediately enter the <strong>R</strong> category rather than <strong>S</strong> at birth.</p></li>
<li><p>The parameter <code>alpha</code> specifies the rate of death induced by the disease. This quantity of individuals is removed from the <strong>I</strong> population. Because <code>alpha</code> can in fact lead to population size change, we now need to recalculate <code>N</code> with each time step, reflecting the changing total population size.</p></li>
</ol>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="class-7-infectious-diseases.html#cb182-1" tabindex="-1"></a>SEIR <span class="ot">&lt;-</span> <span class="cf">function</span>(S, E, I, R, <span class="co"># Starting number of individuals</span></span>
<span id="cb182-2"><a href="class-7-infectious-diseases.html#cb182-2" tabindex="-1"></a>                mu, B, gamma, sigma, alpha, p, <span class="co"># death/birth rate, contact lengths, recovery rate, disease progression rate, death rate from disease, vaccination proportion</span></span>
<span id="cb182-3"><a href="class-7-infectious-diseases.html#cb182-3" tabindex="-1"></a>                simTime, step){</span>
<span id="cb182-4"><a href="class-7-infectious-diseases.html#cb182-4" tabindex="-1"></a>  </span>
<span id="cb182-5"><a href="class-7-infectious-diseases.html#cb182-5" tabindex="-1"></a>  <span class="co"># Initialize the total population size (start at 100%)</span></span>
<span id="cb182-6"><a href="class-7-infectious-diseases.html#cb182-6" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb182-7"><a href="class-7-infectious-diseases.html#cb182-7" tabindex="-1"></a>  </span>
<span id="cb182-8"><a href="class-7-infectious-diseases.html#cb182-8" tabindex="-1"></a>  <span class="co"># lists to store population sizes</span></span>
<span id="cb182-9"><a href="class-7-infectious-diseases.html#cb182-9" tabindex="-1"></a>  sList <span class="ot">&lt;-</span> <span class="fu">c</span>(S)</span>
<span id="cb182-10"><a href="class-7-infectious-diseases.html#cb182-10" tabindex="-1"></a>  eList <span class="ot">&lt;-</span> <span class="fu">c</span>(E)</span>
<span id="cb182-11"><a href="class-7-infectious-diseases.html#cb182-11" tabindex="-1"></a>  iList <span class="ot">&lt;-</span> <span class="fu">c</span>(I)</span>
<span id="cb182-12"><a href="class-7-infectious-diseases.html#cb182-12" tabindex="-1"></a>  rList <span class="ot">&lt;-</span> <span class="fu">c</span>(R)</span>
<span id="cb182-13"><a href="class-7-infectious-diseases.html#cb182-13" tabindex="-1"></a>  </span>
<span id="cb182-14"><a href="class-7-infectious-diseases.html#cb182-14" tabindex="-1"></a>  <span class="co"># loop through times</span></span>
<span id="cb182-15"><a href="class-7-infectious-diseases.html#cb182-15" tabindex="-1"></a>  <span class="cf">for</span> (time <span class="cf">in</span> <span class="fu">seq</span>(simTime<span class="sc">/</span>step)){</span>
<span id="cb182-16"><a href="class-7-infectious-diseases.html#cb182-16" tabindex="-1"></a>    <span class="co"># Calculate rates of change </span></span>
<span id="cb182-17"><a href="class-7-infectious-diseases.html#cb182-17" tabindex="-1"></a>    dS <span class="ot">&lt;-</span> (mu <span class="sc">*</span> (N <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">-</span> S) <span class="sc">-</span> B <span class="sc">*</span> I <span class="sc">*</span> S <span class="sc">/</span> N) <span class="sc">*</span> step <span class="co"># (1-p) reflects vaccination</span></span>
<span id="cb182-18"><a href="class-7-infectious-diseases.html#cb182-18" tabindex="-1"></a>    dE <span class="ot">&lt;-</span> (B <span class="sc">*</span> I <span class="sc">*</span> S <span class="sc">/</span> N <span class="sc">-</span> (mu <span class="sc">+</span> sigma) <span class="sc">*</span> E) <span class="sc">*</span> step</span>
<span id="cb182-19"><a href="class-7-infectious-diseases.html#cb182-19" tabindex="-1"></a>    dI <span class="ot">&lt;-</span> (sigma <span class="sc">*</span> E <span class="sc">-</span> (mu <span class="sc">+</span> gamma <span class="sc">+</span> alpha) <span class="sc">*</span> I) <span class="sc">*</span> step </span>
<span id="cb182-20"><a href="class-7-infectious-diseases.html#cb182-20" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> (gamma <span class="sc">*</span> I <span class="sc">-</span> mu <span class="sc">*</span> R <span class="sc">+</span> mu <span class="sc">*</span> N <span class="sc">*</span> p) <span class="sc">*</span> step <span class="co"># mu * N * p reflects vaccination</span></span>
<span id="cb182-21"><a href="class-7-infectious-diseases.html#cb182-21" tabindex="-1"></a>    </span>
<span id="cb182-22"><a href="class-7-infectious-diseases.html#cb182-22" tabindex="-1"></a>    <span class="co"># Update population sizes based on rates of change</span></span>
<span id="cb182-23"><a href="class-7-infectious-diseases.html#cb182-23" tabindex="-1"></a>    S <span class="ot">&lt;-</span> S <span class="sc">+</span> dS</span>
<span id="cb182-24"><a href="class-7-infectious-diseases.html#cb182-24" tabindex="-1"></a>    E <span class="ot">&lt;-</span> E <span class="sc">+</span> dE </span>
<span id="cb182-25"><a href="class-7-infectious-diseases.html#cb182-25" tabindex="-1"></a>    I <span class="ot">&lt;-</span> I <span class="sc">+</span> dI </span>
<span id="cb182-26"><a href="class-7-infectious-diseases.html#cb182-26" tabindex="-1"></a>    R <span class="ot">&lt;-</span> R <span class="sc">+</span> dR</span>
<span id="cb182-27"><a href="class-7-infectious-diseases.html#cb182-27" tabindex="-1"></a>    </span>
<span id="cb182-28"><a href="class-7-infectious-diseases.html#cb182-28" tabindex="-1"></a>    <span class="co"># Update lists</span></span>
<span id="cb182-29"><a href="class-7-infectious-diseases.html#cb182-29" tabindex="-1"></a>    sList <span class="ot">&lt;-</span> <span class="fu">c</span>(sList, S)</span>
<span id="cb182-30"><a href="class-7-infectious-diseases.html#cb182-30" tabindex="-1"></a>    eList <span class="ot">&lt;-</span> <span class="fu">c</span>(eList, E)</span>
<span id="cb182-31"><a href="class-7-infectious-diseases.html#cb182-31" tabindex="-1"></a>    iList <span class="ot">&lt;-</span> <span class="fu">c</span>(iList, I)</span>
<span id="cb182-32"><a href="class-7-infectious-diseases.html#cb182-32" tabindex="-1"></a>    rList <span class="ot">&lt;-</span> <span class="fu">c</span>(rList, R)</span>
<span id="cb182-33"><a href="class-7-infectious-diseases.html#cb182-33" tabindex="-1"></a>    </span>
<span id="cb182-34"><a href="class-7-infectious-diseases.html#cb182-34" tabindex="-1"></a>    <span class="co"># Recalculate total population size</span></span>
<span id="cb182-35"><a href="class-7-infectious-diseases.html#cb182-35" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">sum</span>(S, E, I, R)</span>
<span id="cb182-36"><a href="class-7-infectious-diseases.html#cb182-36" tabindex="-1"></a>  }</span>
<span id="cb182-37"><a href="class-7-infectious-diseases.html#cb182-37" tabindex="-1"></a>  <span class="co"># Store results to data frame</span></span>
<span id="cb182-38"><a href="class-7-infectious-diseases.html#cb182-38" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb182-39"><a href="class-7-infectious-diseases.html#cb182-39" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(<span class="fu">length</span>(sList)) <span class="sc">*</span> step,</span>
<span id="cb182-40"><a href="class-7-infectious-diseases.html#cb182-40" tabindex="-1"></a>    <span class="at">S =</span> sList, </span>
<span id="cb182-41"><a href="class-7-infectious-diseases.html#cb182-41" tabindex="-1"></a>    <span class="at">E =</span> eList, </span>
<span id="cb182-42"><a href="class-7-infectious-diseases.html#cb182-42" tabindex="-1"></a>    <span class="at">I =</span> iList,</span>
<span id="cb182-43"><a href="class-7-infectious-diseases.html#cb182-43" tabindex="-1"></a>    <span class="at">R =</span> rList</span>
<span id="cb182-44"><a href="class-7-infectious-diseases.html#cb182-44" tabindex="-1"></a>  )</span>
<span id="cb182-45"><a href="class-7-infectious-diseases.html#cb182-45" tabindex="-1"></a>  </span>
<span id="cb182-46"><a href="class-7-infectious-diseases.html#cb182-46" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb182-47"><a href="class-7-infectious-diseases.html#cb182-47" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, running on a population:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="class-7-infectious-diseases.html#cb183-1" tabindex="-1"></a><span class="co"># Initializing proportion of individuals in each population </span></span>
<span id="cb183-2"><a href="class-7-infectious-diseases.html#cb183-2" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fl">0.19</span></span>
<span id="cb183-3"><a href="class-7-infectious-diseases.html#cb183-3" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fl">0.0</span></span>
<span id="cb183-4"><a href="class-7-infectious-diseases.html#cb183-4" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb183-5"><a href="class-7-infectious-diseases.html#cb183-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb183-6"><a href="class-7-infectious-diseases.html#cb183-6" tabindex="-1"></a></span>
<span id="cb183-7"><a href="class-7-infectious-diseases.html#cb183-7" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">50</span> <span class="sc">*</span> <span class="dv">52</span>) <span class="co"># Birth rate</span></span>
<span id="cb183-8"><a href="class-7-infectious-diseases.html#cb183-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Contact lengths </span></span>
<span id="cb183-9"><a href="class-7-infectious-diseases.html#cb183-9" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Time spent exposed prior to symptoms </span></span>
<span id="cb183-10"><a href="class-7-infectious-diseases.html#cb183-10" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Recovery rate </span></span>
<span id="cb183-11"><a href="class-7-infectious-diseases.html#cb183-11" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Death rate from sickness </span></span>
<span id="cb183-12"><a href="class-7-infectious-diseases.html#cb183-12" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># At Birth Vaccination Rate</span></span>
<span id="cb183-13"><a href="class-7-infectious-diseases.html#cb183-13" tabindex="-1"></a></span>
<span id="cb183-14"><a href="class-7-infectious-diseases.html#cb183-14" tabindex="-1"></a>simTime <span class="ot">&lt;-</span> <span class="dv">52</span> <span class="sc">*</span> <span class="dv">50</span></span>
<span id="cb183-15"><a href="class-7-infectious-diseases.html#cb183-15" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb183-16"><a href="class-7-infectious-diseases.html#cb183-16" tabindex="-1"></a></span>
<span id="cb183-17"><a href="class-7-infectious-diseases.html#cb183-17" tabindex="-1"></a><span class="co"># Run Simulation</span></span>
<span id="cb183-18"><a href="class-7-infectious-diseases.html#cb183-18" tabindex="-1"></a>SEIR_data <span class="ot">&lt;-</span> <span class="fu">SEIR</span>(S, E, I, R, mu, B, gamma, sigma, alpha, p, simTime, step)</span>
<span id="cb183-19"><a href="class-7-infectious-diseases.html#cb183-19" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb183-20"><a href="class-7-infectious-diseases.html#cb183-20" tabindex="-1"></a><span class="fu">plotSIR</span>(SEIR_data)</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SEIR.png" /></p>
<p>Now, plotting just the infected population:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="class-7-infectious-diseases.html#cb184-1" tabindex="-1"></a><span class="fu">plotInfected</span>(SEIR_data)</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SEIR_I.png" /></p>
<p>And lastly, overlaying the infected and exposed populations on the same figure:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="class-7-infectious-diseases.html#cb185-1" tabindex="-1"></a><span class="fu">ggplot</span>(SEIR_data, <span class="fu">aes</span>(<span class="at">x =</span> S, <span class="at">y =</span> I)) <span class="sc">+</span></span>
<span id="cb185-2"><a href="class-7-infectious-diseases.html#cb185-2" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb185-3"><a href="class-7-infectious-diseases.html#cb185-3" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> SEIR_data, <span class="fu">aes</span>(<span class="at">x =</span> S, <span class="at">y =</span> E), <span class="at">color =</span> <span class="st">&quot;plum&quot;</span>) <span class="sc">+</span> </span>
<span id="cb185-4"><a href="class-7-infectious-diseases.html#cb185-4" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SEIR_path.png" /></p>
</div>
<div id="seihfr" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> SEIHFR<a href="class-7-infectious-diseases.html#seihfr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You aren’t responsible for being able to reproduce the code below, but I showed this model in class and am including the code below.</p>
<p>The SEIHFR model was developed to model Ebola outbreaks. In addition to the categories of individuals included in the SEIR model, it also considers:</p>
<ul>
<li><strong>H</strong>ospitalized individuals</li>
<li>Deceased individuals who have not yet been buried at a <strong>F</strong>uneral.</li>
</ul>
<p>Also note that this model accounts for different transmission rates for different categories of individuals. This is to say, terms such as <code>B</code> are separated into <code>Bs</code>, <code>Be</code>, <code>Bi</code>, etc. reflectedin that fact that different sectors of society behave differently based on whether they are sick or not.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="class-7-infectious-diseases.html#cb186-1" tabindex="-1"></a>SEIHFR <span class="ot">&lt;-</span> <span class="cf">function</span>(S, E, I, H, Funeral, R, <span class="co"># F spelled out due to protected terms </span></span>
<span id="cb186-2"><a href="class-7-infectious-diseases.html#cb186-2" tabindex="-1"></a>                             Bs, Be, Bi, Bh, Bf, <span class="co"># All non-removed classes have beta parameters </span></span>
<span id="cb186-3"><a href="class-7-infectious-diseases.html#cb186-3" tabindex="-1"></a>                             gammaH, gammaF, gammaR, <span class="co"># Progression rate from infection to hospitalization, death, or recovery</span></span>
<span id="cb186-4"><a href="class-7-infectious-diseases.html#cb186-4" tabindex="-1"></a>                             <span class="co"># 1/gamma is the time to each of those fates</span></span>
<span id="cb186-5"><a href="class-7-infectious-diseases.html#cb186-5" tabindex="-1"></a>                             theta, <span class="co"># Θ - proportion infected that are hospitalized</span></span>
<span id="cb186-6"><a href="class-7-infectious-diseases.html#cb186-6" tabindex="-1"></a>                             lambda, <span class="co">#Λ - proportion of the sick that will die</span></span>
<span id="cb186-7"><a href="class-7-infectious-diseases.html#cb186-7" tabindex="-1"></a>                             etaF, etaR,  <span class="co"># η - Progression from hospitalization to death or recovery</span></span>
<span id="cb186-8"><a href="class-7-infectious-diseases.html#cb186-8" tabindex="-1"></a>                             chi, mu, <span class="co"># time to burial</span></span>
<span id="cb186-9"><a href="class-7-infectious-diseases.html#cb186-9" tabindex="-1"></a>                             simTime, step){</span>
<span id="cb186-10"><a href="class-7-infectious-diseases.html#cb186-10" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># total population size </span></span>
<span id="cb186-11"><a href="class-7-infectious-diseases.html#cb186-11" tabindex="-1"></a>  </span>
<span id="cb186-12"><a href="class-7-infectious-diseases.html#cb186-12" tabindex="-1"></a>  <span class="co"># Lists to store values of S, I, R</span></span>
<span id="cb186-13"><a href="class-7-infectious-diseases.html#cb186-13" tabindex="-1"></a>  sList <span class="ot">&lt;-</span> <span class="fu">c</span>(S)</span>
<span id="cb186-14"><a href="class-7-infectious-diseases.html#cb186-14" tabindex="-1"></a>  eList <span class="ot">&lt;-</span> <span class="fu">c</span>(E)</span>
<span id="cb186-15"><a href="class-7-infectious-diseases.html#cb186-15" tabindex="-1"></a>  iList <span class="ot">&lt;-</span> <span class="fu">c</span>(I)</span>
<span id="cb186-16"><a href="class-7-infectious-diseases.html#cb186-16" tabindex="-1"></a>  hList <span class="ot">&lt;-</span> <span class="fu">c</span>(H)</span>
<span id="cb186-17"><a href="class-7-infectious-diseases.html#cb186-17" tabindex="-1"></a>  fList <span class="ot">&lt;-</span> <span class="fu">c</span>(Funeral)</span>
<span id="cb186-18"><a href="class-7-infectious-diseases.html#cb186-18" tabindex="-1"></a>  rList <span class="ot">&lt;-</span> <span class="fu">c</span>(R)</span>
<span id="cb186-19"><a href="class-7-infectious-diseases.html#cb186-19" tabindex="-1"></a>  </span>
<span id="cb186-20"><a href="class-7-infectious-diseases.html#cb186-20" tabindex="-1"></a>  <span class="cf">for</span> (time <span class="cf">in</span> <span class="fu">seq</span>(simTime<span class="sc">/</span>step)){</span>
<span id="cb186-21"><a href="class-7-infectious-diseases.html#cb186-21" tabindex="-1"></a>    <span class="co"># Calculate rates of change</span></span>
<span id="cb186-22"><a href="class-7-infectious-diseases.html#cb186-22" tabindex="-1"></a>    </span>
<span id="cb186-23"><a href="class-7-infectious-diseases.html#cb186-23" tabindex="-1"></a>    <span class="co"># Change in number of susceptible </span></span>
<span id="cb186-24"><a href="class-7-infectious-diseases.html#cb186-24" tabindex="-1"></a>    <span class="co"># Interactions of susceptible individuals with Infected, Hospitalized, and dead individuals</span></span>
<span id="cb186-25"><a href="class-7-infectious-diseases.html#cb186-25" tabindex="-1"></a>    dS <span class="ot">&lt;-</span> (mu <span class="sc">*</span> (N <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">-</span> S)<span class="sc">-</span>(Bi <span class="sc">*</span> I <span class="sc">+</span> Bh <span class="sc">*</span> H <span class="sc">+</span> Bf <span class="sc">*</span> Funeral) <span class="sc">*</span> S <span class="sc">/</span> N) <span class="sc">*</span> step</span>
<span id="cb186-26"><a href="class-7-infectious-diseases.html#cb186-26" tabindex="-1"></a>    </span>
<span id="cb186-27"><a href="class-7-infectious-diseases.html#cb186-27" tabindex="-1"></a>    <span class="co"># Change in number exposed </span></span>
<span id="cb186-28"><a href="class-7-infectious-diseases.html#cb186-28" tabindex="-1"></a>    <span class="co"># First term: number of susceptible individuals that get exposed</span></span>
<span id="cb186-29"><a href="class-7-infectious-diseases.html#cb186-29" tabindex="-1"></a>    <span class="co"># Same as dS with opposite sign</span></span>
<span id="cb186-30"><a href="class-7-infectious-diseases.html#cb186-30" tabindex="-1"></a>    <span class="co"># Second term: number of exposed individuals that proceed to being infected</span></span>
<span id="cb186-31"><a href="class-7-infectious-diseases.html#cb186-31" tabindex="-1"></a>    dE <span class="ot">&lt;-</span> ((Bi <span class="sc">*</span> I <span class="sc">+</span> Bh <span class="sc">*</span> H <span class="sc">+</span> Bf <span class="sc">*</span> Funeral) <span class="sc">*</span> S <span class="sc">/</span> N <span class="sc">-</span> sigma <span class="sc">*</span> E) <span class="sc">*</span> step</span>
<span id="cb186-32"><a href="class-7-infectious-diseases.html#cb186-32" tabindex="-1"></a>    </span>
<span id="cb186-33"><a href="class-7-infectious-diseases.html#cb186-33" tabindex="-1"></a>    <span class="co"># Change in number of infected</span></span>
<span id="cb186-34"><a href="class-7-infectious-diseases.html#cb186-34" tabindex="-1"></a>    <span class="co"># First term: number of exposed that become infected</span></span>
<span id="cb186-35"><a href="class-7-infectious-diseases.html#cb186-35" tabindex="-1"></a>    <span class="co"># Second term: progression from infection to hospitalization </span></span>
<span id="cb186-36"><a href="class-7-infectious-diseases.html#cb186-36" tabindex="-1"></a>    <span class="co"># Third term: Recovery</span></span>
<span id="cb186-37"><a href="class-7-infectious-diseases.html#cb186-37" tabindex="-1"></a>    <span class="co"># Fourth term: Death</span></span>
<span id="cb186-38"><a href="class-7-infectious-diseases.html#cb186-38" tabindex="-1"></a>    dI <span class="ot">&lt;-</span> (sigma <span class="sc">*</span> E <span class="sc">-</span> theta <span class="sc">*</span> gammaH <span class="sc">*</span> I <span class="sc">-</span> </span>
<span id="cb186-39"><a href="class-7-infectious-diseases.html#cb186-39" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> lambda) <span class="sc">*</span> gammaR <span class="sc">*</span> I <span class="sc">-</span> </span>
<span id="cb186-40"><a href="class-7-infectious-diseases.html#cb186-40" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> lambda <span class="sc">*</span> gammaF <span class="sc">*</span> I) <span class="sc">*</span> step</span>
<span id="cb186-41"><a href="class-7-infectious-diseases.html#cb186-41" tabindex="-1"></a>    </span>
<span id="cb186-42"><a href="class-7-infectious-diseases.html#cb186-42" tabindex="-1"></a>    <span class="co"># Change in the number hospitalized</span></span>
<span id="cb186-43"><a href="class-7-infectious-diseases.html#cb186-43" tabindex="-1"></a>    <span class="co"># First term: Progression from infection to hospitalization</span></span>
<span id="cb186-44"><a href="class-7-infectious-diseases.html#cb186-44" tabindex="-1"></a>    <span class="co"># Second term: Progression from hospitalization to death </span></span>
<span id="cb186-45"><a href="class-7-infectious-diseases.html#cb186-45" tabindex="-1"></a>    <span class="co"># Third term: </span></span>
<span id="cb186-46"><a href="class-7-infectious-diseases.html#cb186-46" tabindex="-1"></a>    dH <span class="ot">&lt;-</span> (theta <span class="sc">*</span> gammaH <span class="sc">*</span> I <span class="sc">-</span> <span class="co"># infection to hospitalization</span></span>
<span id="cb186-47"><a href="class-7-infectious-diseases.html#cb186-47" tabindex="-1"></a>             lambda <span class="sc">*</span> etaF <span class="sc">*</span> H <span class="sc">-</span> <span class="co"># hospitalization to death</span></span>
<span id="cb186-48"><a href="class-7-infectious-diseases.html#cb186-48" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">-</span> lambda) <span class="sc">*</span> etaR <span class="sc">*</span> H) <span class="sc">*</span> step <span class="co"># hospitalization to recovery </span></span>
<span id="cb186-49"><a href="class-7-infectious-diseases.html#cb186-49" tabindex="-1"></a>    </span>
<span id="cb186-50"><a href="class-7-infectious-diseases.html#cb186-50" tabindex="-1"></a>    <span class="co"># Change in number dead and unburied</span></span>
<span id="cb186-51"><a href="class-7-infectious-diseases.html#cb186-51" tabindex="-1"></a>    <span class="co"># First term: Progression from infection to death</span></span>
<span id="cb186-52"><a href="class-7-infectious-diseases.html#cb186-52" tabindex="-1"></a>    dFuneral <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> lambda <span class="sc">*</span> gammaF <span class="sc">*</span> I <span class="sc">+</span> <span class="co"># Infection to death. I think this is a typo in the textbook</span></span>
<span id="cb186-53"><a href="class-7-infectious-diseases.html#cb186-53" tabindex="-1"></a>                   lambda <span class="sc">*</span> etaF <span class="sc">*</span> H <span class="sc">-</span> <span class="co"># hospitalization to death</span></span>
<span id="cb186-54"><a href="class-7-infectious-diseases.html#cb186-54" tabindex="-1"></a>                   chi <span class="sc">*</span> Funeral</span>
<span id="cb186-55"><a href="class-7-infectious-diseases.html#cb186-55" tabindex="-1"></a>                 ) <span class="sc">*</span> step</span>
<span id="cb186-56"><a href="class-7-infectious-diseases.html#cb186-56" tabindex="-1"></a>    </span>
<span id="cb186-57"><a href="class-7-infectious-diseases.html#cb186-57" tabindex="-1"></a>    </span>
<span id="cb186-58"><a href="class-7-infectious-diseases.html#cb186-58" tabindex="-1"></a>    <span class="co"># Change in number of recovered</span></span>
<span id="cb186-59"><a href="class-7-infectious-diseases.html#cb186-59" tabindex="-1"></a> </span>
<span id="cb186-60"><a href="class-7-infectious-diseases.html#cb186-60" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> lambda) <span class="sc">*</span> gammaR <span class="sc">*</span> I <span class="sc">+</span> <span class="co"># infected recover</span></span>
<span id="cb186-61"><a href="class-7-infectious-diseases.html#cb186-61" tabindex="-1"></a>          (<span class="dv">1</span> <span class="sc">-</span> lambda) <span class="sc">*</span> etaR <span class="sc">*</span> H <span class="co"># Recovery</span></span>
<span id="cb186-62"><a href="class-7-infectious-diseases.html#cb186-62" tabindex="-1"></a>          <span class="sc">+</span> chi <span class="sc">*</span> Funeral) <span class="sc">*</span> step <span class="co"># burial</span></span>
<span id="cb186-63"><a href="class-7-infectious-diseases.html#cb186-63" tabindex="-1"></a>    </span>
<span id="cb186-64"><a href="class-7-infectious-diseases.html#cb186-64" tabindex="-1"></a>    <span class="co"># Update population sizes</span></span>
<span id="cb186-65"><a href="class-7-infectious-diseases.html#cb186-65" tabindex="-1"></a>    S <span class="ot">&lt;-</span> S <span class="sc">+</span> dS</span>
<span id="cb186-66"><a href="class-7-infectious-diseases.html#cb186-66" tabindex="-1"></a>    E <span class="ot">&lt;-</span> E <span class="sc">+</span> dE</span>
<span id="cb186-67"><a href="class-7-infectious-diseases.html#cb186-67" tabindex="-1"></a>    I <span class="ot">&lt;-</span> I <span class="sc">+</span> dI</span>
<span id="cb186-68"><a href="class-7-infectious-diseases.html#cb186-68" tabindex="-1"></a>    H <span class="ot">&lt;-</span> H <span class="sc">+</span> dH</span>
<span id="cb186-69"><a href="class-7-infectious-diseases.html#cb186-69" tabindex="-1"></a>    Funeral <span class="ot">&lt;-</span> Funeral <span class="sc">+</span> dFuneral</span>
<span id="cb186-70"><a href="class-7-infectious-diseases.html#cb186-70" tabindex="-1"></a>    R <span class="ot">&lt;-</span> R <span class="sc">+</span> dR</span>
<span id="cb186-71"><a href="class-7-infectious-diseases.html#cb186-71" tabindex="-1"></a>    </span>
<span id="cb186-72"><a href="class-7-infectious-diseases.html#cb186-72" tabindex="-1"></a>    <span class="co"># Update population size based on number dead</span></span>
<span id="cb186-73"><a href="class-7-infectious-diseases.html#cb186-73" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">sum</span>(S, E, I, H, Funeral, R)</span>
<span id="cb186-74"><a href="class-7-infectious-diseases.html#cb186-74" tabindex="-1"></a>    </span>
<span id="cb186-75"><a href="class-7-infectious-diseases.html#cb186-75" tabindex="-1"></a>    <span class="co"># Store to list</span></span>
<span id="cb186-76"><a href="class-7-infectious-diseases.html#cb186-76" tabindex="-1"></a>    sList <span class="ot">&lt;-</span> <span class="fu">c</span>(sList, S)</span>
<span id="cb186-77"><a href="class-7-infectious-diseases.html#cb186-77" tabindex="-1"></a>    eList <span class="ot">&lt;-</span> <span class="fu">c</span>(eList, E)</span>
<span id="cb186-78"><a href="class-7-infectious-diseases.html#cb186-78" tabindex="-1"></a>    iList <span class="ot">&lt;-</span> <span class="fu">c</span>(iList, I)</span>
<span id="cb186-79"><a href="class-7-infectious-diseases.html#cb186-79" tabindex="-1"></a>    hList <span class="ot">&lt;-</span> <span class="fu">c</span>(hList, H)</span>
<span id="cb186-80"><a href="class-7-infectious-diseases.html#cb186-80" tabindex="-1"></a>    fList <span class="ot">&lt;-</span> <span class="fu">c</span>(fList, Funeral)</span>
<span id="cb186-81"><a href="class-7-infectious-diseases.html#cb186-81" tabindex="-1"></a>    rList <span class="ot">&lt;-</span> <span class="fu">c</span>(rList, R)</span>
<span id="cb186-82"><a href="class-7-infectious-diseases.html#cb186-82" tabindex="-1"></a>  }</span>
<span id="cb186-83"><a href="class-7-infectious-diseases.html#cb186-83" tabindex="-1"></a>  </span>
<span id="cb186-84"><a href="class-7-infectious-diseases.html#cb186-84" tabindex="-1"></a>  <span class="co"># Store results in df</span></span>
<span id="cb186-85"><a href="class-7-infectious-diseases.html#cb186-85" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb186-86"><a href="class-7-infectious-diseases.html#cb186-86" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(<span class="fu">length</span>(sList)) <span class="sc">*</span> step,</span>
<span id="cb186-87"><a href="class-7-infectious-diseases.html#cb186-87" tabindex="-1"></a>    <span class="at">S =</span> sList, </span>
<span id="cb186-88"><a href="class-7-infectious-diseases.html#cb186-88" tabindex="-1"></a>    <span class="at">E =</span> eList, </span>
<span id="cb186-89"><a href="class-7-infectious-diseases.html#cb186-89" tabindex="-1"></a>    <span class="at">I =</span> iList,</span>
<span id="cb186-90"><a href="class-7-infectious-diseases.html#cb186-90" tabindex="-1"></a>    <span class="at">H =</span> hList,</span>
<span id="cb186-91"><a href="class-7-infectious-diseases.html#cb186-91" tabindex="-1"></a>    <span class="at">Funeral =</span> fList,</span>
<span id="cb186-92"><a href="class-7-infectious-diseases.html#cb186-92" tabindex="-1"></a>    <span class="at">R =</span> rList</span>
<span id="cb186-93"><a href="class-7-infectious-diseases.html#cb186-93" tabindex="-1"></a>  )</span>
<span id="cb186-94"><a href="class-7-infectious-diseases.html#cb186-94" tabindex="-1"></a>  </span>
<span id="cb186-95"><a href="class-7-infectious-diseases.html#cb186-95" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb186-96"><a href="class-7-infectious-diseases.html#cb186-96" tabindex="-1"></a>}</span></code></pre></div>
<p>Now running the simulation:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="class-7-infectious-diseases.html#cb187-1" tabindex="-1"></a><span class="co"># Initialize simulation parameters</span></span>
<span id="cb187-2"><a href="class-7-infectious-diseases.html#cb187-2" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fl">0.99</span> <span class="co"># Susceptible </span></span>
<span id="cb187-3"><a href="class-7-infectious-diseases.html#cb187-3" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fl">0.0</span>  <span class="co"># Exposed</span></span>
<span id="cb187-4"><a href="class-7-infectious-diseases.html#cb187-4" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fl">0.01</span>  <span class="co"># Infected</span></span>
<span id="cb187-5"><a href="class-7-infectious-diseases.html#cb187-5" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Hospitalized</span></span>
<span id="cb187-6"><a href="class-7-infectious-diseases.html#cb187-6" tabindex="-1"></a>Funeral <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb187-7"><a href="class-7-infectious-diseases.html#cb187-7" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">0.0</span> <span class="co"># Recovered </span></span>
<span id="cb187-8"><a href="class-7-infectious-diseases.html#cb187-8" tabindex="-1"></a></span>
<span id="cb187-9"><a href="class-7-infectious-diseases.html#cb187-9" tabindex="-1"></a><span class="co"># Interaction length parameters</span></span>
<span id="cb187-10"><a href="class-7-infectious-diseases.html#cb187-10" tabindex="-1"></a>Bi <span class="ot">&lt;-</span> <span class="fl">0.588</span></span>
<span id="cb187-11"><a href="class-7-infectious-diseases.html#cb187-11" tabindex="-1"></a>Bh <span class="ot">&lt;-</span> <span class="fl">0.794</span></span>
<span id="cb187-12"><a href="class-7-infectious-diseases.html#cb187-12" tabindex="-1"></a>Bf <span class="ot">&lt;-</span> <span class="fl">7.653</span></span>
<span id="cb187-13"><a href="class-7-infectious-diseases.html#cb187-13" tabindex="-1"></a></span>
<span id="cb187-14"><a href="class-7-infectious-diseases.html#cb187-14" tabindex="-1"></a><span class="co"># Progression rate from infection </span></span>
<span id="cb187-15"><a href="class-7-infectious-diseases.html#cb187-15" tabindex="-1"></a>gammaH <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span></span>
<span id="cb187-16"><a href="class-7-infectious-diseases.html#cb187-16" tabindex="-1"></a>gammaF <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">9.6</span></span>
<span id="cb187-17"><a href="class-7-infectious-diseases.html#cb187-17" tabindex="-1"></a>gammaR <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb187-18"><a href="class-7-infectious-diseases.html#cb187-18" tabindex="-1"></a></span>
<span id="cb187-19"><a href="class-7-infectious-diseases.html#cb187-19" tabindex="-1"></a><span class="co"># Progression from hospitalization to death or recovery</span></span>
<span id="cb187-20"><a href="class-7-infectious-diseases.html#cb187-20" tabindex="-1"></a>etaF <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">4.6</span></span>
<span id="cb187-21"><a href="class-7-infectious-diseases.html#cb187-21" tabindex="-1"></a>etaR <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span></span>
<span id="cb187-22"><a href="class-7-infectious-diseases.html#cb187-22" tabindex="-1"></a></span>
<span id="cb187-23"><a href="class-7-infectious-diseases.html#cb187-23" tabindex="-1"></a></span>
<span id="cb187-24"><a href="class-7-infectious-diseases.html#cb187-24" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.80</span> <span class="co"># Hospitalization rate </span></span>
<span id="cb187-25"><a href="class-7-infectious-diseases.html#cb187-25" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">0.81</span> <span class="co"># Death rate </span></span>
<span id="cb187-26"><a href="class-7-infectious-diseases.html#cb187-26" tabindex="-1"></a><span class="co"># Time to burial</span></span>
<span id="cb187-27"><a href="class-7-infectious-diseases.html#cb187-27" tabindex="-1"></a>chi <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb187-28"><a href="class-7-infectious-diseases.html#cb187-28" tabindex="-1"></a>mu <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">/</span>(<span class="dv">50</span> <span class="sc">*</span> <span class="dv">52</span>)</span>
<span id="cb187-29"><a href="class-7-infectious-diseases.html#cb187-29" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">7</span> <span class="co"># Length that exposed stay exposed prior to becoming infected</span></span>
<span id="cb187-30"><a href="class-7-infectious-diseases.html#cb187-30" tabindex="-1"></a></span>
<span id="cb187-31"><a href="class-7-infectious-diseases.html#cb187-31" tabindex="-1"></a>simTime <span class="ot">&lt;-</span> <span class="dv">52</span> <span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb187-32"><a href="class-7-infectious-diseases.html#cb187-32" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb187-33"><a href="class-7-infectious-diseases.html#cb187-33" tabindex="-1"></a></span>
<span id="cb187-34"><a href="class-7-infectious-diseases.html#cb187-34" tabindex="-1"></a>SEIHFR_data <span class="ot">&lt;-</span> <span class="fu">SEIHFR</span>(S, E, I, H, Funeral, R, </span>
<span id="cb187-35"><a href="class-7-infectious-diseases.html#cb187-35" tabindex="-1"></a>                 Bs, Be, Bi, Bh, Bf,</span>
<span id="cb187-36"><a href="class-7-infectious-diseases.html#cb187-36" tabindex="-1"></a>                 gammaH, gammaF, gammaR, </span>
<span id="cb187-37"><a href="class-7-infectious-diseases.html#cb187-37" tabindex="-1"></a>                 theta,lambda, </span>
<span id="cb187-38"><a href="class-7-infectious-diseases.html#cb187-38" tabindex="-1"></a>                 etaF, etaR,</span>
<span id="cb187-39"><a href="class-7-infectious-diseases.html#cb187-39" tabindex="-1"></a>                 chi, mu,</span>
<span id="cb187-40"><a href="class-7-infectious-diseases.html#cb187-40" tabindex="-1"></a>                 simTime, step)</span>
<span id="cb187-41"><a href="class-7-infectious-diseases.html#cb187-41" tabindex="-1"></a></span>
<span id="cb187-42"><a href="class-7-infectious-diseases.html#cb187-42" tabindex="-1"></a></span>
<span id="cb187-43"><a href="class-7-infectious-diseases.html#cb187-43" tabindex="-1"></a><span class="co"># Convert to tall format</span></span>
<span id="cb187-44"><a href="class-7-infectious-diseases.html#cb187-44" tabindex="-1"></a>SEIHFR_data_tall <span class="ot">&lt;-</span> <span class="fu">melt</span>(SEIHFR_data, <span class="at">id.vars =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb187-45"><a href="class-7-infectious-diseases.html#cb187-45" tabindex="-1"></a><span class="fu">colnames</span>(SEIHFR_data_tall) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Size&quot;</span>)</span>
<span id="cb187-46"><a href="class-7-infectious-diseases.html#cb187-46" tabindex="-1"></a></span>
<span id="cb187-47"><a href="class-7-infectious-diseases.html#cb187-47" tabindex="-1"></a><span class="fu">ggplot</span>(SEIHFR_data_tall[SEIHFR_data_tall<span class="sc">$</span>Population <span class="sc">!=</span> <span class="st">&quot;R&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Time <span class="sc">*</span> step <span class="sc">/</span> <span class="dv">52</span>,</span>
<span id="cb187-48"><a href="class-7-infectious-diseases.html#cb187-48" tabindex="-1"></a>               <span class="at">y =</span> Size,</span>
<span id="cb187-49"><a href="class-7-infectious-diseases.html#cb187-49" tabindex="-1"></a>               <span class="at">color =</span> Population)) <span class="sc">+</span></span>
<span id="cb187-50"><a href="class-7-infectious-diseases.html#cb187-50" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb187-51"><a href="class-7-infectious-diseases.html#cb187-51" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Population Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-52"><a href="class-7-infectious-diseases.html#cb187-52" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb187-53"><a href="class-7-infectious-diseases.html#cb187-53" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>)</span></code></pre></div>
<p><img src="06-Infectious-Diseases/img/SEIHFR.png" /></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="class-5-lotka-volterra-i-competition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="class-9-the-wright-fisher-model-i---neutral-evolution.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
