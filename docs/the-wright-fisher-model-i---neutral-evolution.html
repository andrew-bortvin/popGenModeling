<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 The Wright-Fisher Model I - Neutral Evolution | Population Genetics Modeling</title>
  <meta name="description" content="Description of Course" />
  <meta name="generator" content="bookdown 0.39.1 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 The Wright-Fisher Model I - Neutral Evolution | Population Genetics Modeling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Description of Course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 The Wright-Fisher Model I - Neutral Evolution | Population Genetics Modeling" />
  
  <meta name="twitter:description" content="Description of Course" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/pig.jpg" type="image/x-icon" />
<link rel="prev" href="class-7-infectious-diseases.html"/>
<link rel="next" href="r-guidebook.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://andrew-bortvin.github.io/popGenModeling/"><img src="assets/pig.jpg" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top"</a>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Homepage</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#course-updates"><i class="fa fa-check"></i><b>1.0.1</b> Course Updates</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="course-syllabus.html"><a href="course-syllabus.html"><i class="fa fa-check"></i><b>2</b> Course Syllabus</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="course-syllabus.html"><a href="course-syllabus.html#course-description"><i class="fa fa-check"></i><b>2.0.1</b> Course Description</a></li>
<li class="chapter" data-level="2.0.2" data-path="course-syllabus.html"><a href="course-syllabus.html#learning-goals"><i class="fa fa-check"></i><b>2.0.2</b> Learning Goals</a></li>
<li class="chapter" data-level="2.0.3" data-path="course-syllabus.html"><a href="course-syllabus.html#grading"><i class="fa fa-check"></i><b>2.0.3</b> Grading</a></li>
<li class="chapter" data-level="2.0.4" data-path="course-syllabus.html"><a href="course-syllabus.html#schedule"><i class="fa fa-check"></i><b>2.0.4</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lecture-notes.html"><a href="lecture-notes.html"><i class="fa fa-check"></i><b>3</b> Lecture Notes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html"><i class="fa fa-check"></i><b>3.1</b> Class 2: Intro to R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#data-types-variables-math"><i class="fa fa-check"></i><b>3.1.1</b> Data Types, Variables, Math</a></li>
<li class="chapter" data-level="3.1.2" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#comparing-values"><i class="fa fa-check"></i><b>3.1.2</b> Comparing Values</a></li>
<li class="chapter" data-level="3.1.3" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#collections"><i class="fa fa-check"></i><b>3.1.3</b> Collections</a></li>
<li class="chapter" data-level="3.1.4" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#iteration"><i class="fa fa-check"></i><b>3.1.4</b> Iteration</a></li>
<li class="chapter" data-level="3.1.5" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#data-frames-tabular-data"><i class="fa fa-check"></i><b>3.1.5</b> Data Frames: Tabular Data</a></li>
<li class="chapter" data-level="3.1.6" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#plotting"><i class="fa fa-check"></i><b>3.1.6</b> Plotting</a></li>
<li class="chapter" data-level="3.1.7" data-path="class-2-intro-to-r.html"><a href="class-2-intro-to-r.html#wide-to-long"><i class="fa fa-check"></i><b>3.1.7</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html"><i class="fa fa-check"></i><b>3.2</b> Class 3: Exponential Growth and Age Structure</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#comparison-to-real-data"><i class="fa fa-check"></i><b>3.2.1</b> Comparison to Real Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#age-structure"><i class="fa fa-check"></i><b>3.2.2</b> Age Structure</a></li>
<li class="chapter" data-level="3.2.3" data-path="class-3-exponential-growth-and-age-structure.html"><a href="class-3-exponential-growth-and-age-structure.html#the-leslie-matrix"><i class="fa fa-check"></i><b>3.2.3</b> The Leslie Matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="class-5-lotka-volterra-i-competition.html"><a href="class-5-lotka-volterra-i-competition.html"><i class="fa fa-check"></i><b>3.3</b> Class 5: Lotka-Volterra I: Competition</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="class-5-lotka-volterra-i-competition.html"><a href="class-5-lotka-volterra-i-competition.html#equilibirum-from-multiple-starting-points"><i class="fa fa-check"></i><b>3.3.1</b> Equilibirum from multiple starting points</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html"><i class="fa fa-check"></i><b>3.4</b> Class 7: Infectious Diseases</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#the-sir-model"><i class="fa fa-check"></i><b>3.4.1</b> The SIR Model</a></li>
<li class="chapter" data-level="3.4.2" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#seir"><i class="fa fa-check"></i><b>3.4.2</b> SEIR</a></li>
<li class="chapter" data-level="3.4.3" data-path="class-7-infectious-diseases.html"><a href="class-7-infectious-diseases.html#seihfr"><i class="fa fa-check"></i><b>3.4.3</b> SEIHFR</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-wright-fisher-model-i---neutral-evolution.html"><a href="the-wright-fisher-model-i---neutral-evolution.html"><i class="fa fa-check"></i><b>3.5</b> The Wright-Fisher Model I - Neutral Evolution</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-wright-fisher-model-i---neutral-evolution.html"><a href="the-wright-fisher-model-i---neutral-evolution.html#random-walks"><i class="fa fa-check"></i><b>3.5.1</b> Random Walks</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-wright-fisher-model-i---neutral-evolution.html"><a href="the-wright-fisher-model-i---neutral-evolution.html#wright-fisher-simulation"><i class="fa fa-check"></i><b>3.5.2</b> Wright-Fisher Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-guidebook.html"><a href="r-guidebook.html"><i class="fa fa-check"></i><b>4</b> R Guidebook</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>4.1</b> Data Types</a></li>
<li class="chapter" data-level="4.2" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>4.2</b> Variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="variables.html"><a href="variables.html#overwriting-variables"><i class="fa fa-check"></i><b>4.2.1</b> Overwriting Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>4.3</b> Math</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="math.html"><a href="math.html#order-of-operations"><i class="fa fa-check"></i><b>4.3.1</b> Order of Operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="comparisons.html"><a href="comparisons.html"><i class="fa fa-check"></i><b>4.4</b> Comparisons</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="comparisons.html"><a href="comparisons.html#and-and-or"><i class="fa fa-check"></i><b>4.4.1</b> AND and OR</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>4.5</b> Vectors</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="vectors.html"><a href="vectors.html#indexing-1"><i class="fa fa-check"></i><b>4.5.1</b> Indexing</a></li>
<li class="chapter" data-level="4.5.2" data-path="vectors.html"><a href="vectors.html#logical-indexing-1"><i class="fa fa-check"></i><b>4.5.2</b> Logical Indexing</a></li>
<li class="chapter" data-level="4.5.3" data-path="vectors.html"><a href="vectors.html#modifying-vectors"><i class="fa fa-check"></i><b>4.5.3</b> Modifying Vectors</a></li>
<li class="chapter" data-level="4.5.4" data-path="vectors.html"><a href="vectors.html#adding-to-vectors-1"><i class="fa fa-check"></i><b>4.5.4</b> Adding to Vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>4.6</b> Data Frames</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-frames.html"><a href="data-frames.html#subsetting-data-frames"><i class="fa fa-check"></i><b>4.6.1</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="4.6.2" data-path="data-frames.html"><a href="data-frames.html#logical-indexing-2"><i class="fa fa-check"></i><b>4.6.2</b> Logical Indexing</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="plotting-1.html"><a href="plotting-1.html"><i class="fa fa-check"></i><b>4.7</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-slides.html"><a href="lecture-slides.html"><i class="fa fa-check"></i><b>5</b> Lecture Slides</a></li>
<li class="chapter" data-level="" data-path="authors.html"><a href="authors.html"><i class="fa fa-check"></i>Authors</a></li>
<li class="divider"></li>
<p style="text-align:center; font-size: 11pt"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > Published with</a> <a href="https://bookdown.org/" target="blank"> <b>bookdown</b></a> (by <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab</a>) </p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Population Genetics Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,initial-scale=1.0">
  <link href="assets/style.css" rel="stylesheet">
</head>



<div class="hero-image-container">
  <img class="hero-image" src="assets/ilum.jpg">
</div>
<div id="the-wright-fisher-model-i---neutral-evolution" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> The Wright-Fisher Model I - Neutral Evolution<a href="the-wright-fisher-model-i---neutral-evolution.html#the-wright-fisher-model-i---neutral-evolution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb188-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb188-2" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<p>The Wright-Fisher model provides us with a simulation-based appraoch to examine the fluctuations in allele frequency across generations. This model makes a large number of assumptions about the nature of populations, including:</p>
<ul>
<li>Constant population size</li>
<li>Everyone reproduces once per generation, at the same time</li>
<li>No selection</li>
<li>No mutation</li>
<li>Random mating</li>
</ul>
<p>And while these are all simplifications compared to any real world biological system, the model allows us to make powerful predictions about genetic variation.</p>
<p>Since this will be our first time working with random simulation, let’s first model a simpler scenario - the Random Walk.</p>
<div id="random-walks" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Random Walks<a href="the-wright-fisher-model-i---neutral-evolution.html#random-walks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Random Walk simulates the motion of a particle moving randomly - think of a diffusing molecule or a small bacterium. At every time step, the particle can move a distance in any direction. The direction and magnitude of motion are independent of past behavior, hence making it random (this is more formally called a Markov Process).</p>
<p>When simulating the random walk, we can generate random x and y displacements using the <code>runif()</code> function.</p>
<p>The conventional arguments for <code>runif()</code> are <code>runif(n, min, max)</code>, with <code>n</code> being the number of random values to return and <code>min</code> and <code>max</code> being the upper and lower bounds.</p>
<p>For example, 5 random numbers between 10 and 12:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb189-1" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb189-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb189-2" tabindex="-1"></a>      <span class="at">min =</span> <span class="dv">10</span>,</span>
<span id="cb189-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb189-3" tabindex="-1"></a>      <span class="at">max =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## [1] 10.74503 11.84529 10.99377 11.25278 11.71908</code></pre>
<p>Now, the random walk function, taking as an argument the number of time steps to walk:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-1" tabindex="-1"></a>randomWalk <span class="ot">&lt;-</span> <span class="cf">function</span>(timeSteps){</span>
<span id="cb191-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-2" tabindex="-1"></a>  <span class="co"># Initialize starting coordinates</span></span>
<span id="cb191-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb191-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb191-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-5" tabindex="-1"></a>  </span>
<span id="cb191-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-6" tabindex="-1"></a>  <span class="co"># Vectors to store positions</span></span>
<span id="cb191-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-7" tabindex="-1"></a>  x_positions <span class="ot">&lt;-</span> <span class="fu">c</span>(x)</span>
<span id="cb191-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-8" tabindex="-1"></a>  y_positions <span class="ot">&lt;-</span> <span class="fu">c</span>(y)</span>
<span id="cb191-9"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-9" tabindex="-1"></a>  </span>
<span id="cb191-10"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-10" tabindex="-1"></a>  <span class="co"># Loop through require number of time steps</span></span>
<span id="cb191-11"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(timeSteps)){</span>
<span id="cb191-12"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-12" tabindex="-1"></a>    <span class="co"># Randomly update my x and y positions</span></span>
<span id="cb191-13"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-13" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># Can move between one unit left and one unit right </span></span>
<span id="cb191-14"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-14" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">+</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb191-15"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-15" tabindex="-1"></a>    </span>
<span id="cb191-16"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-16" tabindex="-1"></a>    <span class="co"># update lists</span></span>
<span id="cb191-17"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-17" tabindex="-1"></a>    x_positions <span class="ot">&lt;-</span> <span class="fu">c</span>(x_positions, x)</span>
<span id="cb191-18"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-18" tabindex="-1"></a>    y_positions <span class="ot">&lt;-</span> <span class="fu">c</span>(y_positions, y)</span>
<span id="cb191-19"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-19" tabindex="-1"></a>  }</span>
<span id="cb191-20"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-20" tabindex="-1"></a>  </span>
<span id="cb191-21"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-21" tabindex="-1"></a>  <span class="co"># Combine into data frame</span></span>
<span id="cb191-22"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-22" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb191-23"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-23" tabindex="-1"></a>    <span class="at">x =</span> x_positions, </span>
<span id="cb191-24"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-24" tabindex="-1"></a>    <span class="at">y =</span> y_positions</span>
<span id="cb191-25"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-25" tabindex="-1"></a>  )</span>
<span id="cb191-26"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-26" tabindex="-1"></a>  </span>
<span id="cb191-27"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-27" tabindex="-1"></a>  <span class="co"># Return the data frame to user</span></span>
<span id="cb191-28"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-28" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb191-29"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb191-29" tabindex="-1"></a>}</span></code></pre></div>
<p>We can run this function once and plot the path taken:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-1" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(<span class="dv">100</span>) </span>
<span id="cb192-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-2" tabindex="-1"></a></span>
<span id="cb192-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-3" tabindex="-1"></a><span class="fu">ggplot</span>(path, <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb192-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-4" tabindex="-1"></a>               <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb192-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-5" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb192-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;X&quot;</span>) <span class="sc">+</span> </span>
<span id="cb192-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb192-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="resources/images/resources/images/resources/images/resources/images/resources/images/resources/images/popGenModeling_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>Because there is randomness in this model, no one iteration of the random walk is sufficient to describe the overall behavior of the system.</p>
<p>However, we can easily run our model multiple times:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-1" tabindex="-1"></a><span class="co"># Run once</span></span>
<span id="cb193-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(<span class="dv">100</span>) </span>
<span id="cb193-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-3" tabindex="-1"></a><span class="co"># Add a column keeping track of the trial number</span></span>
<span id="cb193-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-4" tabindex="-1"></a>path[<span class="st">&quot;trial&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb193-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-5" tabindex="-1"></a></span>
<span id="cb193-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-6" tabindex="-1"></a><span class="co"># Run 999 more times</span></span>
<span id="cb193-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">999</span>)){ <span class="co"># Note that we start with trial 2</span></span>
<span id="cb193-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-8" tabindex="-1"></a>  <span class="co"># temporary data frame to store each iteration of the results</span></span>
<span id="cb193-9"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-9" tabindex="-1"></a>  toAdd <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(<span class="dv">100</span>) </span>
<span id="cb193-10"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-10" tabindex="-1"></a>  toAdd[<span class="st">&quot;trial&quot;</span>] <span class="ot">&lt;-</span> i </span>
<span id="cb193-11"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-11" tabindex="-1"></a>  </span>
<span id="cb193-12"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-12" tabindex="-1"></a>  <span class="co"># add to path data frame </span></span>
<span id="cb193-13"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-13" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">rbind</span>(path, toAdd)</span>
<span id="cb193-14"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-14" tabindex="-1"></a>}</span>
<span id="cb193-15"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-15" tabindex="-1"></a></span>
<span id="cb193-16"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-16" tabindex="-1"></a><span class="co"># Plot the paths taken in each trial  </span></span>
<span id="cb193-17"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-17" tabindex="-1"></a><span class="fu">ggplot</span>(path, <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb193-18"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-18" tabindex="-1"></a>               <span class="at">y =</span> y,</span>
<span id="cb193-19"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-19" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">factor</span>(trial))) <span class="sc">+</span> <span class="co"># trial number converted to factor to make this into discrete categories</span></span>
<span id="cb193-20"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-20" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">alpha =</span> <span class="fl">0.08</span>) <span class="sc">+</span> <span class="co"># Reducing the opacity</span></span>
<span id="cb193-21"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-21" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb193-22"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-22" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;X&quot;</span>) <span class="sc">+</span> </span>
<span id="cb193-23"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-23" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb193-24"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb193-24" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="co"># We remove the color legend, since it takes up the whole plotting space</span></span></code></pre></div>
<p><img src="resources/images/resources/images/resources/images/resources/images/resources/images/resources/images/popGenModeling_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>Each individual run is quite faint here, but you can see that in total they all cluster around the center. If we care about the ultimate expected position of the particle given an arbitrary run time, we can summarize this with a histogram:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-1" tabindex="-1"></a><span class="co"># Vectors to store final positions</span></span>
<span id="cb194-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-2" tabindex="-1"></a>finalX <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb194-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-3" tabindex="-1"></a>finalY <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb194-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-4" tabindex="-1"></a></span>
<span id="cb194-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-5" tabindex="-1"></a><span class="co"># Run simulation 1000 times</span></span>
<span id="cb194-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1000</span>)){</span>
<span id="cb194-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-7" tabindex="-1"></a>  <span class="co"># Run the simulation</span></span>
<span id="cb194-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-8" tabindex="-1"></a>  toAdd <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(<span class="dv">100</span>) </span>
<span id="cb194-9"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-9" tabindex="-1"></a>  </span>
<span id="cb194-10"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-10" tabindex="-1"></a>  <span class="co"># Get the final coordinates and add to vectors</span></span>
<span id="cb194-11"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-11" tabindex="-1"></a>  finalX <span class="ot">&lt;-</span> <span class="fu">c</span>(finalX, </span>
<span id="cb194-12"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-12" tabindex="-1"></a>              toAdd<span class="sc">$</span>x[<span class="fu">nrow</span>(toAdd)]) <span class="co"># Final x</span></span>
<span id="cb194-13"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-13" tabindex="-1"></a>  finalY <span class="ot">&lt;-</span> <span class="fu">c</span>(finalY, </span>
<span id="cb194-14"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-14" tabindex="-1"></a>              toAdd<span class="sc">$</span>y[<span class="fu">nrow</span>(toAdd)]) <span class="co"># Final y</span></span>
<span id="cb194-15"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-15" tabindex="-1"></a>}</span>
<span id="cb194-16"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-16" tabindex="-1"></a></span>
<span id="cb194-17"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-17" tabindex="-1"></a><span class="co"># Convert to df</span></span>
<span id="cb194-18"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-18" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb194-19"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-19" tabindex="-1"></a>  <span class="at">x =</span> finalX, </span>
<span id="cb194-20"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-20" tabindex="-1"></a>  <span class="at">y =</span> finalY</span>
<span id="cb194-21"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-21" tabindex="-1"></a>)</span>
<span id="cb194-22"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-22" tabindex="-1"></a></span>
<span id="cb194-23"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-23" tabindex="-1"></a><span class="co"># Plot as a histogram</span></span>
<span id="cb194-24"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-24" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb194-25"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-25" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> finalX), <span class="at">fill =</span> <span class="st">&quot;plum&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb194-26"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-26" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> finalY), <span class="at">fill =</span> <span class="st">&quot;turquoise&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb194-27"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-27" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Position at at Time Step 100&quot;</span>) <span class="sc">+</span> </span>
<span id="cb194-28"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb194-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="resources/images/resources/images/resources/images/resources/images/resources/images/resources/images/popGenModeling_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>Confirming our observations from the above figure, the random walk centers around the starting position. Now with these techinques under our belt, we’re ready to simulate the Wright-Fisher model.</p>
</div>
<div id="wright-fisher-simulation" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Wright-Fisher Simulation<a href="the-wright-fisher-model-i---neutral-evolution.html#wright-fisher-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our simulation of the Wright-Fisher model is conceptually similar to the random walk. We start at some allele frequency, and every generation there is a random displacement of the allele frequency, representing the actions of genetic drift.</p>
<p>In the random walk, displacement was drawn from the uniform distribution and the magnitude was equally likely to be any value between the min and the max. Here, since we are modelling many independent reproduction events, each of which has a probability of passing our allele to the next generation, we will instead use the binomial formula to draw the number of copies of our allele.</p>
<p>Drawing from the binomial formula can be done using the <code>rbinom()</code> function. Normal use of the <code>rbinom()</code> function takes three parameters: <code>rbinom(n, size, p)</code>, with <code>n</code> being the number of values to draw, <code>size</code> being the number of trials, and <code>p</code> being the likelihood of success for each individual trial.</p>
<p>For example, 3 binomial values, with 10 trials each and a success rate of 80%:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb196-1" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">3</span>,</span>
<span id="cb196-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb196-2" tabindex="-1"></a>       <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb196-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb196-3" tabindex="-1"></a>       <span class="at">p =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## [1] 6 6 5</code></pre>
<p>For us, the number of trials is the number of chromosomes in the population and the success rate per trial is the frequency of our allele in the population.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-1" tabindex="-1"></a>WF <span class="ot">&lt;-</span> <span class="cf">function</span>(AF, popSize){</span>
<span id="cb198-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-2" tabindex="-1"></a>  <span class="co"># Calculate the number of chromosomes in the population</span></span>
<span id="cb198-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-3" tabindex="-1"></a>  nChrom <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> popSize </span>
<span id="cb198-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-4" tabindex="-1"></a>  </span>
<span id="cb198-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-5" tabindex="-1"></a>  <span class="co"># Create a list to store allele frequencies across time </span></span>
<span id="cb198-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-6" tabindex="-1"></a>  AFs <span class="ot">&lt;-</span> <span class="fu">c</span>(AF)</span>
<span id="cb198-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-7" tabindex="-1"></a>  </span>
<span id="cb198-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-8" tabindex="-1"></a>  <span class="cf">while</span> (AF <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> AF <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb198-9"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-9" tabindex="-1"></a>    <span class="co"># Get number of copies of my allele in next generation </span></span>
<span id="cb198-10"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-10" tabindex="-1"></a>    nAlleleNextGen <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, </span>
<span id="cb198-11"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-11" tabindex="-1"></a>                             <span class="at">size =</span> nChrom, </span>
<span id="cb198-12"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-12" tabindex="-1"></a>                             <span class="at">p =</span> AF)</span>
<span id="cb198-13"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-13" tabindex="-1"></a>    </span>
<span id="cb198-14"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-14" tabindex="-1"></a>    <span class="co"># Convert to allele frequency</span></span>
<span id="cb198-15"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-15" tabindex="-1"></a>    AF <span class="ot">&lt;-</span> nAlleleNextGen <span class="sc">/</span> nChrom</span>
<span id="cb198-16"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-16" tabindex="-1"></a>    </span>
<span id="cb198-17"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-17" tabindex="-1"></a>    <span class="co"># Add to list</span></span>
<span id="cb198-18"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-18" tabindex="-1"></a>    AFs <span class="ot">&lt;-</span> <span class="fu">c</span>(AFs, AF)</span>
<span id="cb198-19"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-19" tabindex="-1"></a>    </span>
<span id="cb198-20"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-20" tabindex="-1"></a>  }</span>
<span id="cb198-21"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-21" tabindex="-1"></a>  </span>
<span id="cb198-22"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-22" tabindex="-1"></a>  <span class="co"># Combined into data frame </span></span>
<span id="cb198-23"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-23" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb198-24"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-24" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">length</span>(AFs) <span class="sc">-</span> <span class="dv">1</span>), </span>
<span id="cb198-25"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-25" tabindex="-1"></a>    <span class="at">AF =</span> AFs</span>
<span id="cb198-26"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-26" tabindex="-1"></a>  )</span>
<span id="cb198-27"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-27" tabindex="-1"></a>  </span>
<span id="cb198-28"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-28" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb198-29"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb198-29" tabindex="-1"></a>}</span></code></pre></div>
<p>Running this once:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-1" tabindex="-1"></a>AF <span class="ot">&lt;-</span> <span class="fu">WF</span>(<span class="fl">0.5</span>, <span class="dv">1000</span>)</span>
<span id="cb199-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-2" tabindex="-1"></a></span>
<span id="cb199-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-3" tabindex="-1"></a><span class="fu">ggplot</span>(AF, <span class="fu">aes</span>(<span class="at">x =</span> time,</span>
<span id="cb199-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-4" tabindex="-1"></a>               <span class="at">y =</span> AF)) <span class="sc">+</span></span>
<span id="cb199-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb199-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb199-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb199-7" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) </span></code></pre></div>
<p><img src="resources/images/resources/images/resources/images/resources/images/resources/images/resources/images/popGenModeling_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<p>Multiple iterations of the model:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-1" tabindex="-1"></a><span class="co"># Run the model once</span></span>
<span id="cb200-2"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-2" tabindex="-1"></a>AF <span class="ot">&lt;-</span> <span class="fu">WF</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">100</span>)</span>
<span id="cb200-3"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-3" tabindex="-1"></a><span class="co"># Add a column to keep track of trial number </span></span>
<span id="cb200-4"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-4" tabindex="-1"></a>AF[<span class="st">&quot;trial&quot;</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb200-5"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-5" tabindex="-1"></a></span>
<span id="cb200-6"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-6" tabindex="-1"></a><span class="co"># Run 499 more times</span></span>
<span id="cb200-7"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">500</span>)){</span>
<span id="cb200-8"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-8" tabindex="-1"></a>  <span class="co"># Temporary df to store current trial</span></span>
<span id="cb200-9"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-9" tabindex="-1"></a>  toAdd <span class="ot">&lt;-</span> <span class="fu">WF</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">100</span>)</span>
<span id="cb200-10"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-10" tabindex="-1"></a>  toAdd[<span class="st">&quot;trial&quot;</span>] <span class="ot">&lt;-</span> i <span class="co"># Add trial number</span></span>
<span id="cb200-11"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-11" tabindex="-1"></a>  </span>
<span id="cb200-12"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-12" tabindex="-1"></a>  <span class="co"># Add to overall df</span></span>
<span id="cb200-13"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-13" tabindex="-1"></a>  AF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(AF, toAdd)</span>
<span id="cb200-14"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-14" tabindex="-1"></a>}</span>
<span id="cb200-15"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-15" tabindex="-1"></a></span>
<span id="cb200-16"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-16" tabindex="-1"></a></span>
<span id="cb200-17"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-17" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb200-18"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-18" tabindex="-1"></a><span class="fu">ggplot</span>(AF, <span class="fu">aes</span>(<span class="at">x =</span> time,</span>
<span id="cb200-19"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-19" tabindex="-1"></a>               <span class="at">y =</span> AF, </span>
<span id="cb200-20"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-20" tabindex="-1"></a>               <span class="at">group =</span> <span class="fu">factor</span>(trial))) <span class="sc">+</span></span>
<span id="cb200-21"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-21" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb200-22"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-22" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb200-23"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-23" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb200-24"><a href="the-wright-fisher-model-i---neutral-evolution.html#cb200-24" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="resources/images/resources/images/resources/images/resources/images/resources/images/resources/images/popGenModeling_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>

</div>
</div>
<!-- </div> -->
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="class-7-infectious-diseases.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-guidebook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
